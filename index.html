<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Real Estate Rent Calculator — Blue · Purple</title>
  <style>
    :root{
      --bg-1:#eef2ff; --bg-2:#f3e8ff; --panel:#ffffff; --panel-2:#f8faff;
      --text:#0f172a; --muted:#475569; --brand:#4f46e5; --brand-2:#8b5cf6; --accent:#93c5fd;
      --ring:rgba(79,70,229,.28);
      --radius:24px; --shadow:0 10px 30px rgba(24,39,75,.18);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font:16px/1.45 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial;
      color:var(--text);
      background: radial-gradient(900px 420px at 10% -10%, rgba(147,197,253,.35), transparent 60%),
                 radial-gradient(800px 520px at 100% -5%, rgba(139,92,246,.28), transparent 62%),
                 linear-gradient(180deg, var(--bg-1), var(--bg-2));
      display:grid; place-items:center; padding:28px;
    }
    .app{width:100%; max-width:1100px; border:3px dashed var(--brand-2); border-radius:var(--radius); padding:20px; background:linear-gradient(180deg,#f5f0ff,#f3e8ff)}
    .header{display:flex; gap:14px; align-items:center; justify-content:space-between; margin-bottom:18px}
    .title{display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.2px; font-size: clamp(20px, 3vw, 28px)}
    .subtitle{color:var(--muted); font-size:14px}
    .house{width:28px; height:28px; display:inline-block}
    .house path.roof{fill:var(--brand)}
    .house path.body{fill:var(--brand-2)}

    .grid{display:grid; grid-template-columns:1.2fr 1fr; gap:18px}
    @media (max-width:860px){.grid{grid-template-columns:1fr}}

    .card{background:linear-gradient(180deg, var(--panel), var(--panel-2)); border:1px solid rgba(79,70,229,.12); border-radius:18px; box-shadow:var(--shadow)}
    .card .hd{padding:14px 16px; border-bottom:1px solid rgba(79,70,229,.12); display:flex; align-items:center; justify-content:space-between; gap:12px}
    .card .bd{padding:16px}

    .row{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    @media (max-width:520px){.row{grid-template-columns:1fr}}

    label{display:block; font-size:12px; color:var(--muted); margin:4px 0 8px}

    input[type="number"], input[type="text"], input[type="date"]{
      width:100%; appearance:none; background:#f6f8ff; color:var(--text);
      border:1px solid rgba(79,70,229,.2); outline:none; border-radius:12px; padding:12px 14px;
      transition: box-shadow .2s ease, border-color .2s ease;
    }
    input:focus{ border-color:var(--brand-2); box-shadow:0 0 0 6px var(--ring) }

    .chips{display:flex; gap:8px; flex-wrap:wrap}
    .chip{border:1px solid rgba(79,70,229,.2); background:#f6f8ff; color:#111827; padding:8px 10px; border-radius:999px; cursor:pointer; font-size:12px}
    .chip:hover{border-color:var(--brand)}

    .btns{display:flex; gap:10px; flex-wrap:wrap}
    .btn{border:1px solid rgba(79,70,229,.2); background: linear-gradient(180deg, #c7d2fe, #a5b4fc); color:#111827; padding:11px 14px; border-radius:12px; cursor:pointer; font-weight:600}
    .btn.primary{background: linear-gradient(180deg, #6366f1, #4f46e5); color:white; border-color:transparent}
    .btn.ghost{background:transparent}
    .btn:active{transform: translateY(1px)}

    .result{display:grid; gap:12px; grid-template-columns:1fr; margin-top:10px}
    .pill{display:flex; align-items:center; justify-content:space-between; gap:10px; padding:14px; border:1px dashed rgba(139,92,246,.35); background:rgba(241,245,255,.75); border-radius:14px}
    .pill strong{font-size:18px}

    .note{font-size:12px; color:var(--muted)}
    .footer{margin-top:16px; text-align:center; color:var(--muted); font-size:12px}
    .footer a{color:var(--brand)}
  </style>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-6FV3QNNPE7"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-6FV3QNNPE7');
  </script>
</head>
<body>
  <div class="app">
    <div class="header">
      <div>
        <div class="title">
          <svg class="house" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><path class="roof" d="M2 32 L32 6 L62 32 Z"/><path class="body" d="M12 30 H52 V58 H12 Z"/></svg>
          Real Estate Rent Calculator
        </div>
        <div class="subtitle">Fast proportional splits with up to 3 leases</div>
      </div>
    </div>

    <div class="grid">
      <section class="card" aria-label="inputs">
        <div class="hd"><strong>Inputs</strong><span class="note" id="statusMsg">Ready</span></div>
        <div class="bd">
          <form id="calcForm">
            <div class="row">
              <div>
                <label for="monthly">Monthly rent (USD)</label>
                <input id="monthly" type="text" inputmode="decimal" placeholder="e.g., 2403.00" />
              </div>
              <div>
                <label for="daysInMonth">Days in month</label>
                <input id="daysInMonth" type="number" min="1" placeholder="e.g., 31 or any value" />
                <div class="chips" style="margin-top:8px">
                  <button class="chip" data-days="28" type="button">28</button>
                  <button class="chip" data-days="29" type="button">29</button>
                  <button class="chip" data-days="30" type="button">30</button>
                  <button class="chip" data-days="31" type="button">31</button>
                </div>
              </div>
            </div>

            <!-- Lease ranges -->
            <div id="dateRanges">
              <div class="row">
                <div>
                  <label>1st lease start</label>
                  <input type="date" id="start1" />
                </div>
                <div>
                  <label>1st lease end</label>
                  <input type="date" id="end1" />
                </div>
              </div>
              <div class="row">
                <div>
                  <label>2nd lease start</label>
                  <input type="date" id="start2" />
                </div>
                <div>
                  <label>2nd lease end</label>
                  <input type="date" id="end2" />
                </div>
              </div>
              <div class="row">
                <div>
                  <label>3rd lease start</label>
                  <input type="date" id="start3" />
                </div>
                <div>
                  <label>3rd lease end</label>
                  <input type="date" id="end3" />
                </div>
              </div>
            </div>

            <div class="btns" style="margin-top:10px">
              <button class="btn primary" id="calcBtn" type="button">Calculate</button>
              <button class="btn ghost" id="clearBtn" type="button">Clear</button>
            </div>
          </form>
        </div>
      </section>

      <section class="card" aria-label="results">
        <div class="hd"><strong>Results</strong>
          <div class="btns">
            <button class="btn" id="downloadCsvBtn" type="button">Download CSV</button>
            <button class="btn" id="downloadXlsxBtn" type="button">Download XLSX</button>
          </div>
        </div>
        <div class="bd">
          <div class="result">
            <div class="pill"><span class="note">Per day</span> <strong id="perDay">—</strong></div>
            <div class="pill"><span class="note">1st lease <span id="d1" class="note"></span></span> <strong id="range1">—</strong></div>
            <div class="pill"><span class="note">2nd lease <span id="d2" class="note"></span></span> <strong id="range2">—</strong></div>
            <div class="pill"><span class="note">3rd lease <span id="d3" class="note"></span></span> <strong id="range3">—</strong></div>
            <div class="pill"><span class="note">Total</span> <strong id="total">—</strong></div>
          </div>
        </div>
      </section>
    </div>

    <div class="footer">
      Made by <strong>Mari Harouche</strong> with love &lt;3<br>
      <span class="note">Formula: (Monthly Rent ÷ Days in Month) × Number of Days in Lease.</span>
    </div>
  </div>

  <!-- External libs for XLSX export with styles -->
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    // ===== Elements
    const monthly = document.getElementById('monthly');
    const daysInMonth = document.getElementById('daysInMonth');
    const perDayEl = document.getElementById('perDay');
    const r1El = document.getElementById('range1');
    const r2El = document.getElementById('range2');
    const r3El = document.getElementById('range3');
    const totalEl = document.getElementById('total');

    const start1 = document.getElementById('start1');
    const end1   = document.getElementById('end1');
    const start2 = document.getElementById('start2');
    const end2   = document.getElementById('end2');
    const start3 = document.getElementById('start3');
    const end3   = document.getElementById('end3');

    const calcBtn = document.getElementById('calcBtn');
    const clearBtn = document.getElementById('clearBtn');
    const downloadCsvBtn = document.getElementById('downloadCsvBtn');
    const downloadXlsxBtn = document.getElementById('downloadXlsxBtn');

    const d1Label = document.getElementById('d1');
    const d2Label = document.getElementById('d2');
    const d3Label = document.getElementById('d3');

    // Delegate chips
    document.addEventListener('click', (e)=>{
      const t = e.target.closest('.chip[data-days]');
      if(!t) return;
      e.preventDefault();
      daysInMonth.value = t.dataset.days;
      compute();
    });

    // ===== Helpers
    function parseMoney(input){
      if(!input) return NaN;
      const s = String(input)
        .replace(/\s/g,'')
        .replace(/\.(?=\d{3}(\D|$))/g,'')
        .replace(/,/g,'.');
      return Number(s);
    }
    function formatMoney(value){
      if(!isFinite(value)) return '—';
      return new Intl.NumberFormat('en-US', { style:'currency', currency:'USD' }).format(value);
    }
    function daysBetween(start, end){
      if(!start || !end) return 0;
      const [sy, sm, sd] = start.split('-').map(Number);
      const [ey, em, ed] = end.split('-').map(Number);
      const a = Date.UTC(sy, (sm||1)-1, sd||1);
      const b = Date.UTC(ey, (em||1)-1, ed||1);
      const diffDays = Math.floor((b - a) / (1000*60*60*24)) + 1; // inclusive
      return diffDays > 0 ? diffDays : 0;
    }

    // ===== Core compute
    function compute(){
      const m = parseMoney(monthly.value);
      const dim = Number(daysInMonth.value);

      const d1 = daysBetween(start1.value, end1.value);
      const d2 = daysBetween(start2.value, end2.value);
      const d3 = daysBetween(start3.value, end3.value);

      d1Label.textContent = d1 ? `• ${d1} days` : '';
      d2Label.textContent = d2 ? `• ${d2} days` : '';
      d3Label.textContent = d3 ? `• ${d3} days` : '';

      if(!isFinite(m) || !isFinite(dim) || dim<=0){
        perDayEl.textContent = '—';
        r1El.textContent = '—';
        r2El.textContent = '—';
        r3El.textContent = '—';
        totalEl.textContent = '—';
        return null;
      }

      const perDay = m / dim;
      perDayEl.textContent = formatMoney(perDay);

      const v1 = perDay * d1;
      const v2 = perDay * d2;
      const v3 = perDay * d3;
      const total = v1 + v2 + v3;

      r1El.textContent = d1 ? formatMoney(v1) : '—';
      r2El.textContent = d2 ? formatMoney(v2) : '—';
      r3El.textContent = d3 ? formatMoney(v3) : '—';
      totalEl.textContent = (d1||d2||d3) ? formatMoney(total) : '—';

      return { m, dim, perDay, d1, d2, d3, v1, v2, v3, total };
    }

    // ===== Clear
    function clearAll(){
      monthly.value=''; daysInMonth.value='';
      start1.value=''; end1.value='';
      start2.value=''; end2.value='';
      start3.value=''; end3.value='';
      compute();
    }

    // ===== CSV / XLSX helpers
    function toCSVRow(arr){
      return arr.map(v => {
        const s = String(v ?? '');
        return /[",\n]/.test(s) ? '"'+s.replace(/"/g,'""')+'"' : s;
      }).join(',');
    }
    function dateStamp(){
      const d = new Date();
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,'0');
      const day = String(d.getDate()).padStart(2,'0');
      return `${y}-${m}-${day}`;
    }

    function downloadCSV(){
      const data = compute();
      if(!data){ alert('Fill Monthly and Days in month first.'); return; }
      const { m, dim, perDay, d1, d2, d3, v1, v2, v3, total } = data;
      let rows = [];
      rows.push(toCSVRow(['Monthly',m.toFixed(2),'DaysInMonth',dim,'PerDay',perDay.toFixed(2)]));
      rows.push('');
      rows.push(toCSVRow(['LeaseNo','Days','Value']));
      if(d1>0) rows.push(toCSVRow(['1st', d1, v1.toFixed(2)]));
      if(d2>0) rows.push(toCSVRow(['2nd', d2, v2.toFixed(2)]));
      if(d3>0) rows.push(toCSVRow(['3rd', d3, v3.toFixed(2)]));
      rows.push(toCSVRow(['Total','', total.toFixed(2)]));
      const blob = new Blob([rows.join('\n')], { type: 'text/csv;charset=utf-8;' });
      saveAs(blob, `rent-calculation_${dateStamp()}.csv`);
    }

    async function downloadXLSX(){
      if(!window.ExcelJS || !window.saveAs){ alert('Exporter not loaded.'); return;
